function init(){var e=document.querySelector("article.md-text");const d=e&&(e.classList.contains("sa-load-hidden")||e.classList.contains("blur")),r=document.querySelector("body");document.querySelectorAll("figure.highlight").forEach(o=>{var e=o.querySelector(".code"),s=document.createElement("div"),t=(s.classList.add("code-btns"),document.createElement("div"));if(t.classList.add("btn"),t.classList.add("fullscreen-btn"),t.innerHTML=`<i class='fa-duotone fa-expand fa-fw'></i><span class="desc">放大</span>`,!d){const codeFullscreenBtnDesc=t.querySelector("span"),codeFullscreenBtnIcon=t.querySelector("i")}t.addEventListener("click",()=>{if(d){document.querySelector(".fullscreen")?.remove();let e=o.cloneNode(!0);var a=document.createElement("div");a.classList.add("fullscreen"),a.appendChild(e);let s=e.querySelector(".copy-btn"),t=s.querySelector("i"),c=s.querySelector("span");s.addEventListener("click",async()=>{await copyCode(e.querySelector(".code").children[0]?.innerText),c.innerText=stellar.GLOBAL_CONFIG.plugins.copycode.success_text,s.classList.add("success"),t.classList.remove("fa-copy"),t.classList.remove("fa-circle-exclamation"),t.classList.add("fa-circle-check"),util.messageCopyright(),setTimeout(()=>{c.innerText=stellar.GLOBAL_CONFIG.plugins.copycode.default_text,s.classList.remove("success"),t.classList.remove("fa-check"),t.classList.add("fa-copy")},2e3)});var l=e.querySelector(".fullscreen-btn"),n=l.querySelector("i"),i=l.querySelector("span");l.addEventListener("click",()=>{r.removeAttribute("style"),util.animateOut(e,"slide-out .5s")}),n.classList.remove("fa-expand"),n.classList.add("fa-compress"),i.innerText="缩小",r.appendChild(a),r.setAttribute("style","overflow:hidden;"),util.animateIn(e,"slide-in .5s")}else stellar.requestAnimationFrame(()=>{o.classList.toggle("fullscreen"),o.classList.contains("fullscreen")?(codeFullscreenBtnIcon.classList.remove("fa-expand"),codeFullscreenBtnIcon.classList.add("fa-compress"),codeFullscreenBtnDesc.innerText="缩小",r.setAttribute("style","overflow:hidden;")):(codeFullscreenBtnIcon.classList.remove("fa-compress"),codeFullscreenBtnIcon.classList.add("fa-expand"),codeFullscreenBtnDesc.innerText="放大",r.removeAttribute("style"),util.animateOut(o,"slide-out .5s"))})}),s.appendChild(t);var t=document.createElement("div"),c=(t.classList.add("btn"),t.classList.add("copy-btn"),t.innerHTML=`<i class='fa-duotone fa-copy fa-fw'></i><span class="desc">${stellar.GLOBAL_CONFIG.plugins.copycode.default_text}</span>`,t.querySelector("i")),a=t.querySelector("span"),t=(s.appendChild(t),copyCode(t,e,c,a),o.getAttribute("class").split(" ")[1]),e=document.createElement("div"),c=(e.classList.add("code-lang"),e.innerHTML=`<span>${t}</span>`,document.createElement("div")),a=(c.classList.add("code-btns-and-lang"),c.appendChild(s),c.appendChild(e),document.createElement("div")),t=(a.classList.add("code-tools"),o.querySelector(".highlight figcaption"));t?a.appendChild(t):((s=document.createElement("figcaption")).innerHTML=`<span>${stellar.GLOBAL_CONFIG.config.default.codeblock_figtext}</span>`,a.appendChild(s)),a.appendChild(c),o.insertBefore(a,o.children[0])})}function copyCode(s,t,c,a){s.onclick=e=>{e.stopPropagation(),t.focus();e=new Range,e.selectNodeContents(t),document.getSelection().removeAllRanges(),document.getSelection().addRange(e),e=document.getSelection().toString();util.writeClipText(e).then(()=>{util.messageCopyright(),a.innerText=stellar.GLOBAL_CONFIG.plugins.copycode.success_text,s.classList.add("success"),c.classList.remove("fa-copy"),c.classList.remove("fa-circle-exclamation"),c.classList.add("fa-circle-check"),setTimeout(()=>{a.innerText=stellar.GLOBAL_CONFIG.plugins.copycode.default_text,s.classList.remove("success"),c.classList.remove("fa-check"),c.classList.add("fa-copy")},2e3)}).catch(e=>{a.innerText=e,s.classList.add("warning"),c.classList.remove("fa-copy"),c.classList.add("fa-circle-exclamation"),hud.message("COPY错误",e,{icon:"fa-duotone fa-exclamation-square red",displayMode:1,time:9e3}),setTimeout(()=>{a.innerText=stellar.GLOBAL_CONFIG.plugins.copycode.default_text,s.classList.remove("warning"),c.classList.remove("fa-circle-exclamation"),c.classList.add("fa-copy")},2e3)})}}function copyLineCode(){document.querySelectorAll("button.copy-btn").forEach(c=>{c.onclick=e=>{e.stopPropagation();const s=c.firstChild;var e=c.previousSibling,t=e.value;e.focus(),e.select(),util.writeClipText(t).then(()=>{util.messageCopyright(),c.classList.add("success"),s.classList.remove("fa-calendar-lines"),s.classList.remove("fa-calendar-xmark"),s.classList.add("fa-calendar-check"),setTimeout(()=>{c.classList.remove("success"),s.classList.remove("fa-calendar-check"),s.classList.add("fa-calendar-lines")},2e3)}).catch(e=>{c.classList.add("warning"),s.classList.remove("fa-calendar-lines"),s.classList.add("fa-calendar-xmark"),hud.message("COPY错误",e,{icon:"fa-duotone fa-exclamation-square red",displayMode:1,time:9e3}),setTimeout(()=>{c.classList.remove("warning"),s.classList.remove("fa-calendar-xmark"),s.classList.add("fa-calendar-lines")},2e3)})}})}init(),copyLineCode();